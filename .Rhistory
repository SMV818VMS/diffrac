main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='l')
par(new=TRUE)
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = range(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
ylim = max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='l')
par(new=TRUE)
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = range(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
# dsspilesmpn <- rollmean(dsspilesmpn, 2)
dsspilesmpn <- TF12_2_5744_CCGTCC[,c(1,2,3)]
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
# dsspilesmpn <- rollmean(dsspilesmpn, 2)
dsspilesmpn <- TF12_2_5744_CCGTCC[,c(1,2,3)]
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
mini <- minlim
maxi <- maxlim
max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))
dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)
dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus
View(dsspilesmpn)
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)
dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus
head(dsspilesmpn)
dsspilesmpn <- TF12_2_5744_CCGTCC[,c(1,2,3)]
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
head(dsspilesmpn$plus)
dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus
max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
ylim = max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='l')
par(new=TRUE)
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='l')
par(new=TRUE)
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='l')
par(new=TRUE)
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='l')
par(new=TRUE)
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='l')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='h', col = 'red')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
minlim <- 0
maxlim <- 2000
plot_coverage(minlim, maxlim)
minlim <- 0
maxlim <- 816394
plot_coverage(minlim, maxlim)
minlim <- 118312
maxlim <- 120000
plot_coverage(minlim, maxlim)
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
dsspilesmpn$plus <- log2(dsspilesmpn$minus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$plus+1)
colnames(dsspilesmpn) <- c('position', 'plus', 'minus')
minlim <- 118312
maxlim <- 120000
plot_coverage(minlim, maxlim)
View(dsspilesmpn)
head(dsspilesmpn)
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
colnames(dsspilesmpn) <- c('position', 'minus', 'plus')
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 118312
maxlim <- 816394
plot_coverage(minlim, maxlim)
minlim <- 118312
maxlim <- 120000
plot_coverage(minlim, maxlim)
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='h', col = 'red')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
colnames(dsspilesmpn) <- c('position', 'minus', 'plus')
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='h', col = 'red')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
colnames(dsspilesmpn) <- c('position', 'minus', 'plus')
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus, type='h', col = 'red')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
colnames(dsspilesmpn) <- c('position', 'minus', 'plus')
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'blue',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position, type='h', col = 'red')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
colnames(dsspilesmpn) <- c('position', 'minus', 'plus')
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'green',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position, type='h', col = 'blue')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
```
```{r}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
colnames(dsspilesmpn) <- c('position', 'minus', 'plus')
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'lightsteelblue1',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position, type='h', col = 'mistyrose1')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
```
```{r}
dsspilesmpn <- read.delim("~/crg/diffrac/datasets/dsspilesmpn.txt")
colnames(dsspilesmpn) <- c('position', 'minus', 'plus')
dsspilesmpn$plus <- log2(dsspilesmpn$plus+1)
dsspilesmpn$minus <- log2(dsspilesmpn$minus+1)
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
```
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
#ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)))),
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'lightsteelblue3',
type='h')
# par(new=TRUE)
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position, type='h', col = 'mistyrose3')
# plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1, type='l', col = 'red', axes =FALSE, xlab='', ylab='', ylim = c(0, max(c(max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus)), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus))))
}
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'lightsteelblue3',
type='l')
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position, type='l', col = 'mistyrose3')
}
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'lightsteelblue3',
type='lh')
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position, type='l', col = 'mistyrose3')
}
plot_coverage(minlim, maxlim)
plot_coverage <- function(mini, maxi){
# Plot the figure
plot(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position,
ylim = range(min(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1), max(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$plus)),
main = paste("Coverage plot",mini,'-', maxi),
xlab = "MPN genome",
ylab='coverage',
col = 'lightskyblue',
type='h')
lines(dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$minus*-1~dsspilesmpn[which(mini<dsspilesmpn$position & dsspilesmpn$position<maxi),]$position, type='h', col = 'rosybrown1')
}
minlim <- 248562
maxlim <- 249878
plot_coverage(minlim, maxlim)
minlim <- 0
maxlim <- 1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- minlim+1500
maxlim <- maxlim+1500
plot_coverage(minlim, maxlim)
minlim <- 0
maxlim <- 816394
plot_coverage(minlim, maxlim)
